<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
><head
  ><link rel="stylesheet" type="text/css" href="style.css"
     /><script type="text/javascript" src="highlight.js"
    ></script
    ></head
  ><body
  ><pre
    ><span class="hs-pragma"
      >{-# LANGUAGE OverloadedStrings, Rank2Types #-}</span
      ><span
      >
</span
      ><a name="line-2"
      ></a
      ><span
      >
</span
      ><a name="line-3"
      ></a
      ><span class="hs-comment"
      >-- | Low-level tools for querying the NationStates API.</span
      ><span
      >
</span
      ><a name="line-4"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-5"
      ></a
      ><span class="hs-comment"
      >-- Most of the time, you should use the high-level wrappers in e.g.</span
      ><span
      >
</span
      ><a name="line-6"
      ></a
      ><span class="hs-comment"
      >-- &quot;NationStates.Nation&quot; instead. But if you need something not provided</span
      ><span
      >
</span
      ><a name="line-7"
      ></a
      ><span class="hs-comment"
      >-- by these wrappers, then feel free to use this module directly.</span
      ><span
      >
</span
      ><a name="line-8"
      ></a
      ><span
      >
</span
      ><a name="line-9"
      ></a
      ><span class="hs-keyword"
      >module</span
      ><span
      > </span
      ><span class="hs-identifier"
      >NationStates</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Core</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span
      >
</span
      ><a name="line-10"
      ></a
      ><span
      >
</span
      ><a name="line-11"
      ></a
      ><span
      >    </span
      ><span class="hs-comment"
      >-- * Requests</span
      ><span
      >
</span
      ><a name="line-12"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#NS"
      ><span class="hs-identifier hs-type"
	>NS</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-13"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#makeNS"
      ><span class="hs-identifier hs-var"
	>makeNS</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-14"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#makeNS%27"
      ><span class="hs-identifier hs-var"
	>makeNS'</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-15"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#requestNS"
      ><span class="hs-identifier hs-var"
	>requestNS</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-16"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#apiVersion"
      ><span class="hs-identifier hs-var"
	>apiVersion</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-17"
      ></a
      ><span
      >
</span
      ><a name="line-18"
      ></a
      ><span
      >    </span
      ><span class="hs-comment"
      >-- * Query strings</span
      ><span
      >
</span
      ><a name="line-19"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#Query"
      ><span class="hs-identifier hs-type"
	>Query</span
	></a
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >..</span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-20"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#shard"
      ><span class="hs-identifier hs-var"
	>shard</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-21"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#shard%27"
      ><span class="hs-identifier hs-var"
	>shard'</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-22"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#withOptions"
      ><span class="hs-identifier hs-var"
	>withOptions</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-23"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#withParams"
      ><span class="hs-identifier hs-var"
	>withParams</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-24"
      ></a
      ><span
      >
</span
      ><a name="line-25"
      ></a
      ><span
      >    </span
      ><span class="hs-comment"
      >-- * Connection manager</span
      ><span
      >
</span
      ><a name="line-26"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#Context"
      ><span class="hs-identifier hs-type"
	>Context</span
	></a
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >..</span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-27"
      ></a
      ><span
      >
</span
      ><a name="line-28"
      ></a
      ><span
      >    </span
      ><span class="hs-comment"
      >-- * Utilities</span
      ><span
      >
</span
      ><a name="line-29"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#wordsBy"
      ><span class="hs-identifier hs-var"
	>wordsBy</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-30"
      ></a
      ><span
      >    </span
      ><span class="hs-identifier hs-var"
      >readMaybe</span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-31"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#expect"
      ><span class="hs-identifier hs-var"
	>expect</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-32"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#pureIf"
      ><span class="hs-identifier hs-var"
	>pureIf</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-33"
      ></a
      ><span
      >
</span
      ><a name="line-34"
      ></a
      ><span
      >    </span
      ><span class="hs-comment"
      >-- * Data structures</span
      ><span
      >
</span
      ><a name="line-35"
      ></a
      ><span
      >    </span
      ><span class="hs-keyword"
      >module</span
      ><span
      > </span
      ><span class="hs-identifier"
      >NationStates</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Types</span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-36"
      ></a
      ><span
      >
</span
      ><a name="line-37"
      ></a
      ><span
      >    </span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><a name="line-38"
      ></a
      ><span
      >
</span
      ><a name="line-39"
      ></a
      ><span
      >
</span
      ><a name="line-40"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Control</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Applicative</span
      ><span
      >
</span
      ><a name="line-41"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Data</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >ByteString</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-type"
      >ByteString</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><a name="line-42"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Data</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >ByteString</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Char8</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="hs-identifier"
      >BC</span
      ><span
      >
</span
      ><a name="line-43"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Data</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Functor</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Compose</span
      ><span
      >
</span
      ><a name="line-44"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Data</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Foldable</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="hs-identifier"
      >F</span
      ><span
      >
</span
      ><a name="line-45"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Data</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >List</span
      ><span
      >
</span
      ><a name="line-46"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Data</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Monoid</span
      ><span
      >
</span
      ><a name="line-47"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Data</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Map</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-type"
      >Map</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><a name="line-48"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Data</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Map</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Map</span
      ><span
      >
</span
      ><a name="line-49"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Data</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Maybe</span
      ><span
      >
</span
      ><a name="line-50"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Data</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Set</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-type"
      >Set</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><a name="line-51"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Data</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Set</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Set</span
      ><span
      >
</span
      ><a name="line-52"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Network</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >HTTP</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Client</span
      ><span
      >
</span
      ><a name="line-53"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-keyword"
      >qualified</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Network</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >HTTP</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Types</span
      ><span
      > </span
      ><span class="hs-keyword"
      >as</span
      ><span
      > </span
      ><span class="hs-identifier"
      >HTTP</span
      ><span
      >
</span
      ><a name="line-54"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Text</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Read</span
      ><span
      >
</span
      ><a name="line-55"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Text</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >XML</span
      ><span class="hs-operator"
      >.</span
      ><span class="hs-identifier"
      >Light</span
      ><span
      >
</span
      ><a name="line-56"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><span class="hs-identifier"
      >Prelude</span
      ><span
      >  </span
      ><span class="hs-comment"
      >-- GHC 7.10</span
      ><span
      >
</span
      ><a name="line-57"
      ></a
      ><span
      >
</span
      ><a name="line-58"
      ></a
      ><span class="hs-keyword"
      >import</span
      ><span
      > </span
      ><a href="NationStates.Types.html"
      ><span class="hs-identifier"
	>NationStates</span
	><span class="hs-operator"
	>.</span
	><span class="hs-identifier"
	>Types</span
	></a
      ><span
      >
</span
      ><a name="line-59"
      ></a
      ><span
      >
</span
      ><a name="line-60"
      ></a
      ><span
      >
</span
      ><a name="line-61"
      ></a
      ><span class="hs-comment"
      >-- | A request to the NationStates API.</span
      ><span
      >
</span
      ><a name="line-62"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-63"
      ></a
      ><span class="hs-comment"
      >-- * Construct an @NS@ using 'makeNS' or 'makeNS''.</span
      ><span
      >
</span
      ><a name="line-64"
      ></a
      ><span class="hs-comment"
      >-- * Compose @NS@ values using the 'Applicative' interface.</span
      ><span
      >
</span
      ><a name="line-65"
      ></a
      ><span class="hs-comment"
      >-- * Execute an @NS@ using 'requestNS'.</span
      ><span
      >
</span
      ><a name="line-66"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-67"
      ></a
      ><span class="hs-comment"
      >-- This type wraps a query string, along with a function that parses the</span
      ><span
      >
</span
      ><a name="line-68"
      ></a
      ><span class="hs-comment"
      >-- response. The funky type machinery keeps these two parts in sync, as</span
      ><span
      >
</span
      ><a name="line-69"
      ></a
      ><span class="hs-comment"
      >-- long as you stick to the 'Applicative' interface.</span
      ><span
      >
</span
      ><a name="line-70"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-71"
      ></a
      ><span class="hs-comment"
      >-- @</span
      ><span
      >
</span
      ><a name="line-72"
      ></a
      ><span class="hs-comment"
      >-- type NS a = ('Query', Query -&gt; 'Element' -&gt; a)</span
      ><span
      >
</span
      ><a name="line-73"
      ></a
      ><span class="hs-comment"
      >-- @</span
      ><span
      >
</span
      ><a name="line-74"
      ></a
      ><span class="hs-keyword"
      >type</span
      ><span
      > </span
      ><a name="NS"
      ><a href="NationStates.Core.html#NS"
	><span class="hs-identifier"
	  >NS</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Compose</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >,</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><a href="NationStates.Core.html#Query"
      ><span class="hs-identifier hs-type"
	>Query</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-type"
      >Compose</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><a href="NationStates.Core.html#Query"
      ><span class="hs-identifier hs-type"
	>Query</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Element</span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><a name="line-75"
      ></a
      ><span
      >
</span
      ><a name="line-76"
      ></a
      ><span
      >
</span
      ><a name="line-77"
      ></a
      ><span class="hs-comment"
      >-- | Construct a request for a single shard.</span
      ><span
      >
</span
      ><a name="line-78"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-79"
      ></a
      ><span class="hs-comment"
      >-- For example, this code requests the</span
      ><span
      >
</span
      ><a name="line-80"
      ></a
      ><span class="hs-comment"
      >-- &lt;https://www.nationstates.net/cgi-bin/api.cgi?nation=testlandia&amp;q=motto &quot;motto&quot;&gt;</span
      ><span
      >
</span
      ><a name="line-81"
      ></a
      ><span class="hs-comment"
      >-- shard:</span
      ><span
      >
</span
      ><a name="line-82"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-83"
      ></a
      ><span class="hs-comment"
      >-- @</span
      ><span
      >
</span
      ><a name="line-84"
      ></a
      ><span class="hs-comment"
      >-- motto :: NS String</span
      ><span
      >
</span
      ><a name="line-85"
      ></a
      ><span class="hs-comment"
      >-- motto = makeNS \&quot;motto\&quot; \&quot;MOTTO\&quot;</span
      ><span
      >
</span
      ><a name="line-86"
      ></a
      ><span class="hs-comment"
      >-- @</span
      ><span
      >
</span
      ><a name="line-87"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-88"
      ></a
      ><span class="hs-comment"
      >-- For more complex requests (e.g. nested elements), try 'makeNS'' instead.</span
      ><span
      >
</span
      ><a name="line-89"
      ></a
      ><span class="hs-identifier"
      >makeNS</span
      ><span
      >
</span
      ><a name="line-90"
      ></a
      ><span
      >    </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span
      >
</span
      ><a name="line-91"
      ></a
      ><span
      >        </span
      ><span class="hs-comment"
      >-- ^ Shard name</span
      ><span
      >
</span
      ><a name="line-92"
      ></a
      ><span
      >    </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span
      >
</span
      ><a name="line-93"
      ></a
      ><span
      >        </span
      ><span class="hs-comment"
      >-- ^ XML element name</span
      ><span
      >
</span
      ><a name="line-94"
      ></a
      ><span
      >    </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><a href="NationStates.Core.html#NS"
      ><span class="hs-identifier hs-type"
	>NS</span
	></a
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span
      >
</span
      ><a name="line-95"
      ></a
      ><a name="makeNS"
      ><a href="NationStates.Core.html#makeNS"
	><span class="hs-identifier"
	  >makeNS</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627434744"
      ><a href="#local-1627434744"
	><span class="hs-identifier"
	  >shardName</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627434745"
      ><a href="#local-1627434745"
	><span class="hs-identifier"
	  >elemName</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><a href="NationStates.Core.html#makeNS%27"
      ><span class="hs-identifier hs-var"
	>makeNS'</span
	></a
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><a href="NationStates.Core.html#shard"
      ><span class="hs-identifier hs-var"
	>shard</span
	></a
      ><span
      > </span
      ><a href="#local-1627434744"
      ><span class="hs-identifier hs-var"
	>shardName</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><a href="#local-1627434746"
      ><span class="hs-identifier hs-var"
	>parse</span
	></a
      ><span
      >
</span
      ><a name="line-96"
      ></a
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><a name="line-97"
      ></a
      ><span
      >    </span
      ><a name="local-1627434746"
      ><a href="#local-1627434746"
	><span class="hs-identifier"
	  >parse</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-identifier"
      >_</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >strContent</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >.</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >fromMaybe</span
      ><span
      > </span
      ><a href="#local-1627434747"
      ><span class="hs-identifier hs-var"
	>errorMissing</span
	></a
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >.</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >findChild</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-var"
      >unqual</span
      ><span
      > </span
      ><a href="#local-1627434745"
      ><span class="hs-identifier hs-var"
	>elemName</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><a name="line-98"
      ></a
      ><span
      >    </span
      ><a name="local-1627434747"
      ><a href="#local-1627434747"
	><span class="hs-identifier"
	  >errorMissing</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >error</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >$</span
      ><span
      > </span
      ><span class="hs-string"
      >&quot;missing &lt;&quot;</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >++</span
      ><span
      > </span
      ><a href="#local-1627434745"
      ><span class="hs-identifier hs-var"
	>elemName</span
	></a
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >++</span
      ><span
      > </span
      ><span class="hs-string"
      >&quot;&gt; element&quot;</span
      ><span
      >
</span
      ><a name="line-99"
      ></a
      ><span
      >
</span
      ><a name="line-100"
      ></a
      ><span
      >
</span
      ><a name="line-101"
      ></a
      ><span class="hs-comment"
      >-- | Construct a request.</span
      ><span
      >
</span
      ><a name="line-102"
      ></a
      ><span class="hs-identifier"
      >makeNS'</span
      ><span
      >
</span
      ><a name="line-103"
      ></a
      ><span
      >    </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><a href="NationStates.Core.html#Query"
      ><span class="hs-identifier hs-type"
	>Query</span
	></a
      ><span
      >
</span
      ><a name="line-104"
      ></a
      ><span
      >        </span
      ><span class="hs-comment"
      >-- ^ Query string</span
      ><span
      >
</span
      ><a name="line-105"
      ></a
      ><span
      >    </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><a href="NationStates.Core.html#Query"
      ><span class="hs-identifier hs-type"
	>Query</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Element</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><a href="#local-1627434743"
      ><span class="hs-identifier hs-type"
	>a</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><a name="line-106"
      ></a
      ><span
      >        </span
      ><span class="hs-comment"
      >-- ^ Function for parsing the response</span
      ><span
      >
</span
      ><a name="line-107"
      ></a
      ><span
      >    </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><a href="NationStates.Core.html#NS"
      ><span class="hs-identifier hs-type"
	>NS</span
	></a
      ><span
      > </span
      ><a href="#local-1627434743"
      ><span class="hs-identifier hs-type"
	>a</span
	></a
      ><span
      >
</span
      ><a name="line-108"
      ></a
      ><a name="makeNS%27"
      ><a href="NationStates.Core.html#makeNS%27"
	><span class="hs-identifier"
	  >makeNS'</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627434785"
      ><a href="#local-1627434785"
	><span class="hs-identifier"
	  >query</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627434786"
      ><a href="#local-1627434786"
	><span class="hs-identifier"
	  >parse</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Compose</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><a href="#local-1627434785"
      ><span class="hs-identifier hs-var"
	>query</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Compose</span
      ><span
      > </span
      ><a href="#local-1627434786"
      ><span class="hs-identifier hs-var"
	>parse</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><a name="line-109"
      ></a
      ><span
      >
</span
      ><a name="line-110"
      ></a
      ><span
      >
</span
      ><a name="line-111"
      ></a
      ><span class="hs-comment"
      >-- | Perform a request on the NationStates API.</span
      ><span
      >
</span
      ><a name="line-112"
      ></a
      ><span class="hs-identifier"
      >requestNS</span
      ><span
      >
</span
      ><a name="line-113"
      ></a
      ><span
      >    </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Maybe</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><a name="line-114"
      ></a
      ><span
      >        </span
      ><span class="hs-comment"
      >-- ^ Request type</span
      ><span
      >
</span
      ><a name="line-115"
      ></a
      ><span
      >    </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><a href="NationStates.Core.html#NS"
      ><span class="hs-identifier hs-type"
	>NS</span
	></a
      ><span
      > </span
      ><a href="#local-1627434742"
      ><span class="hs-identifier hs-type"
	>a</span
	></a
      ><span
      >
</span
      ><a name="line-116"
      ></a
      ><span
      >        </span
      ><span class="hs-comment"
      >-- ^ Set of shards to request</span
      ><span
      >
</span
      ><a name="line-117"
      ></a
      ><span
      >    </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><a href="NationStates.Core.html#Context"
      ><span class="hs-identifier hs-type"
	>Context</span
	></a
      ><span
      >
</span
      ><a name="line-118"
      ></a
      ><span
      >        </span
      ><span class="hs-comment"
      >-- ^ Connection manager</span
      ><span
      >
</span
      ><a name="line-119"
      ></a
      ><span
      >    </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >IO</span
      ><span
      > </span
      ><a href="#local-1627434742"
      ><span class="hs-identifier hs-type"
	>a</span
	></a
      ><span
      >
</span
      ><a name="line-120"
      ></a
      ><a name="requestNS"
      ><a href="NationStates.Core.html#requestNS"
	><span class="hs-identifier"
	  >requestNS</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627434787"
      ><a href="#local-1627434787"
	><span class="hs-identifier"
	  >kindAndName</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-var"
      >Compose</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><a name="local-1627434788"
      ><a href="#local-1627434788"
	><span class="hs-identifier"
	  >q</span
	  ></a
	></a
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Compose</span
      ><span
      > </span
      ><a name="local-1627434789"
      ><a href="#local-1627434789"
	><span class="hs-identifier"
	  >p</span
	  ></a
	></a
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><a name="local-1627434790"
      ><a href="#local-1627434790"
	><span class="hs-identifier"
	  >c</span
	  ></a
	></a
      ><span
      >
</span
      ><a name="line-121"
      ></a
      ><span
      >    </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><a href="#local-1627434791"
      ><span class="hs-identifier hs-var"
	>parse</span
	></a
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >.</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >responseBody</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >&lt;$&gt;</span
      ><span
      >
</span
      ><a name="line-122"
      ></a
      ><span
      >        </span
      ><span class="hs-special"
      >(</span
      ><a href="NationStates.Core.html#contextRateLimit"
      ><span class="hs-identifier hs-var"
	>contextRateLimit</span
	></a
      ><span
      > </span
      ><a href="#local-1627434790"
      ><span class="hs-identifier hs-var"
	>c</span
	></a
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >$</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >httpLbs</span
      ><span
      > </span
      ><a href="#local-1627434792"
      ><span class="hs-identifier hs-var"
	>req</span
	></a
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><a href="NationStates.Core.html#contextManager"
      ><span class="hs-identifier hs-var"
	>contextManager</span
	></a
      ><span
      > </span
      ><a href="#local-1627434790"
      ><span class="hs-identifier hs-var"
	>c</span
	></a
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><a name="line-123"
      ></a
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><a name="line-124"
      ></a
      ><span
      >    </span
      ><a name="local-1627434791"
      ><a href="#local-1627434791"
	><span class="hs-identifier"
	  >parse</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><a href="#local-1627434789"
      ><span class="hs-identifier hs-var"
	>p</span
	></a
      ><span
      > </span
      ><a href="#local-1627434788"
      ><span class="hs-identifier hs-var"
	>q</span
	></a
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >.</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >fromMaybe</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-var"
      >error</span
      ><span
      > </span
      ><span class="hs-string"
      >&quot;invalid response&quot;</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >.</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >parseXMLDoc</span
      ><span
      >
</span
      ><a name="line-125"
      ></a
      ><span
      >    </span
      ><a name="local-1627434792"
      ><a href="#local-1627434792"
	><span class="hs-identifier"
	  >req</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><a href="NationStates.Core.html#initRequest"
      ><span class="hs-identifier hs-var"
	>initRequest</span
	></a
      ><span
      > </span
      ><span class="hs-special"
      >{</span
      ><span
      >
</span
      ><a name="line-126"
      ></a
      ><span
      >        </span
      ><span class="hs-identifier hs-var"
      >queryString</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><a href="NationStates.Core.html#queryToString"
      ><span class="hs-identifier hs-var"
	>queryToString</span
	></a
      ><span
      > </span
      ><a href="#local-1627434787"
      ><span class="hs-identifier hs-var"
	>kindAndName</span
	></a
      ><span
      > </span
      ><a href="#local-1627434788"
      ><span class="hs-identifier hs-var"
	>q</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-127"
      ></a
      ><span
      >        </span
      ><span class="hs-identifier hs-var"
      >requestHeaders</span
      ><span
      >
</span
      ><a name="line-128"
      ></a
      ><span
      >            </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-string"
      >&quot;User-Agent&quot;</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >BC</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >pack</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >$</span
      ><span
      > </span
      ><a href="NationStates.Core.html#contextUserAgent"
      ><span class="hs-identifier hs-var"
	>contextUserAgent</span
	></a
      ><span
      > </span
      ><a href="#local-1627434790"
      ><span class="hs-identifier hs-var"
	>c</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><a name="line-129"
      ></a
      ><span
      >            </span
      ><span class="hs-glyph"
      >:</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >requestHeaders</span
      ><span
      > </span
      ><a href="NationStates.Core.html#initRequest"
      ><span class="hs-identifier hs-var"
	>initRequest</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-130"
      ></a
      ><span
      >        </span
      ><span class="hs-identifier hs-var"
      >port</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><a href="NationStates.Core.html#contextIsSecure"
      ><span class="hs-identifier hs-var"
	>contextIsSecure</span
	></a
      ><span
      > </span
      ><a href="#local-1627434790"
      ><span class="hs-identifier hs-var"
	>c</span
	></a
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="hs-number"
      >443</span
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="hs-number"
      >80</span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-131"
      ></a
      ><span
      >        </span
      ><span class="hs-identifier hs-var"
      >secure</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><a href="NationStates.Core.html#contextIsSecure"
      ><span class="hs-identifier hs-var"
	>contextIsSecure</span
	></a
      ><span
      > </span
      ><a href="#local-1627434790"
      ><span class="hs-identifier hs-var"
	>c</span
	></a
      ><span
      >
</span
      ><a name="line-132"
      ></a
      ><span
      >        </span
      ><span class="hs-special"
      >}</span
      ><span
      >
</span
      ><a name="line-133"
      ></a
      ><span
      >
</span
      ><a name="line-134"
      ></a
      ><span class="hs-identifier"
      >initRequest</span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Request</span
      ><span
      >
</span
      ><a name="line-135"
      ></a
      ><span class="hs-identifier hs-var"
      >Just</span
      ><span
      > </span
      ><a name="local-1912646347"
      ><a href="NationStates.Core.html#initRequest"
	><span class="hs-identifier"
	  >initRequest</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >parseUrl</span
      ><span
      > </span
      ><span class="hs-string"
      >&quot;http://www.nationstates.net/cgi-bin/api.cgi&quot;</span
      ><span
      >
</span
      ><a name="line-136"
      ></a
      ><span
      >
</span
      ><a name="line-137"
      ></a
      ><span
      >
</span
      ><a name="line-138"
      ></a
      ><span class="hs-comment"
      >-- | The version of the NationStates API used by this package.</span
      ><span
      >
</span
      ><a name="line-139"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-140"
      ></a
      ><span class="hs-comment"
      >-- Every request to NationStates includes this number. This means that</span
      ><span
      >
</span
      ><a name="line-141"
      ></a
      ><span class="hs-comment"
      >-- if the response format changes, existing code will continue to work</span
      ><span
      >
</span
      ><a name="line-142"
      ></a
      ><span class="hs-comment"
      >-- under the old API.</span
      ><span
      >
</span
      ><a name="line-143"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-144"
      ></a
      ><span class="hs-comment"
      >-- This number should match the current API version, as given by</span
      ><span
      >
</span
      ><a name="line-145"
      ></a
      ><span class="hs-comment"
      >-- &lt;https://www.nationstates.net/cgi-bin/api.cgi?a=version&gt;. If not,</span
      ><span
      >
</span
      ><a name="line-146"
      ></a
      ><span class="hs-comment"
      >-- please file an issue.</span
      ><span
      >
</span
      ><a name="line-147"
      ></a
      ><span class="hs-identifier"
      >apiVersion</span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Integer</span
      ><span
      >
</span
      ><a name="line-148"
      ></a
      ><a name="apiVersion"
      ><a href="NationStates.Core.html#apiVersion"
	><span class="hs-identifier"
	  >apiVersion</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-number"
      >7</span
      ><span
      >
</span
      ><a name="line-149"
      ></a
      ><span
      >
</span
      ><a name="line-150"
      ></a
      ><span
      >
</span
      ><a name="line-151"
      ></a
      ><span class="hs-comment"
      >-- | Keeps track of rate limits and TLS connections.</span
      ><span
      >
</span
      ><a name="line-152"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-153"
      ></a
      ><span class="hs-comment"
      >-- You should create a single 'Context' at the start of your program,</span
      ><span
      >
</span
      ><a name="line-154"
      ></a
      ><span class="hs-comment"
      >-- then share it between multiple threads and requests.</span
      ><span
      >
</span
      ><a name="line-155"
      ></a
      ><span class="hs-keyword"
      >data</span
      ><span
      > </span
      ><a name="Context"
      ><a href="NationStates.Core.html#Context"
	><span class="hs-identifier"
	  >Context</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><a name="Context"
      ><a href="NationStates.Core.html#Context"
	><span class="hs-identifier"
	  >Context</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-special"
      >{</span
      ><span
      >
</span
      ><a name="line-156"
      ></a
      ><span
      >    </span
      ><a name="contextManager"
      ><a href="NationStates.Core.html#contextManager"
	><span class="hs-identifier"
	  >contextManager</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Manager</span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-157"
      ></a
      ><span
      >    </span
      ><a name="contextRateLimit"
      ><a href="NationStates.Core.html#contextRateLimit"
	><span class="hs-identifier"
	  >contextRateLimit</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-keyword"
      >forall</span
      ><span
      > </span
      ><a name="local-1627433686"
      ><a href="#local-1627433686"
	><span class="hs-identifier"
	  >a</span
	  ></a
	></a
      ><span class="hs-operator"
      >.</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >IO</span
      ><span
      > </span
      ><a href="#local-1627433686"
      ><span class="hs-identifier hs-type"
	>a</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >IO</span
      ><span
      > </span
      ><a href="#local-1627433686"
      ><span class="hs-identifier hs-type"
	>a</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-158"
      ></a
      ><span
      >    </span
      ><a name="contextIsSecure"
      ><a href="NationStates.Core.html#contextIsSecure"
	><span class="hs-identifier"
	  >contextIsSecure</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Bool</span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-159"
      ></a
      ><span
      >    </span
      ><a name="contextUserAgent"
      ><a href="NationStates.Core.html#contextUserAgent"
	><span class="hs-identifier"
	  >contextUserAgent</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span
      >
</span
      ><a name="line-160"
      ></a
      ><span
      >    </span
      ><span class="hs-special"
      >}</span
      ><span
      >
</span
      ><a name="line-161"
      ></a
      ><span
      >
</span
      ><a name="line-162"
      ></a
      ><span
      >
</span
      ><a name="line-163"
      ></a
      ><span class="hs-comment"
      >-- | Keeps track of the set of shards to request.</span
      ><span
      >
</span
      ><a name="line-164"
      ></a
      ><span class="hs-keyword"
      >data</span
      ><span
      > </span
      ><a name="Query"
      ><a href="NationStates.Core.html#Query"
	><span class="hs-identifier"
	  >Query</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><a name="Query"
      ><a href="NationStates.Core.html#Query"
	><span class="hs-identifier"
	  >Query</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-special"
      >{</span
      ><span
      >
</span
      ><a name="line-165"
      ></a
      ><span
      >    </span
      ><a name="queryShards"
      ><a href="NationStates.Core.html#queryShards"
	><span class="hs-identifier"
	  >queryShards</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Map</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-type"
      >Set</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-type"
      >Maybe</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Integer</span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-166"
      ></a
      ><span
      >    </span
      ><a name="queryOptions"
      ><a href="NationStates.Core.html#queryOptions"
	><span class="hs-identifier"
	  >queryOptions</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Map</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-167"
      ></a
      ><span
      >    </span
      ><a name="queryParams"
      ><a href="NationStates.Core.html#queryParams"
	><span class="hs-identifier"
	  >queryParams</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Map</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span
      >
</span
      ><a name="line-168"
      ></a
      ><span
      >    </span
      ><span class="hs-special"
      >}</span
      ><span
      > </span
      ><span class="hs-keyword"
      >deriving</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Show</span
      ><span
      >
</span
      ><a name="line-169"
      ></a
      ><span
      >
</span
      ><a name="line-170"
      ></a
      ><span class="hs-keyword"
      >instance</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Monoid</span
      ><span
      > </span
      ><a href="NationStates.Core.html#Query"
      ><span class="hs-identifier hs-type"
	>Query</span
	></a
      ><span
      > </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><a name="line-171"
      ></a
      ><span
      >    </span
      ><a name="local-1912607540"
      ><span class="hs-identifier"
	>mempty</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><a href="NationStates.Core.html#Query"
      ><span class="hs-identifier hs-var"
	>Query</span
	></a
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >mempty</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >mempty</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >mempty</span
      ><span
      >
</span
      ><a name="line-172"
      ></a
      ><span
      >    </span
      ><a name="local-1912607539"
      ><span class="hs-identifier"
	>mappend</span
	></a
      ><span
      > </span
      ><a name="local-1627435282"
      ><a href="#local-1627435282"
	><span class="hs-identifier"
	  >a</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627435283"
      ><a href="#local-1627435283"
	><span class="hs-identifier"
	  >b</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><a href="NationStates.Core.html#Query"
      ><span class="hs-identifier hs-var"
	>Query</span
	></a
      ><span
      > </span
      ><span class="hs-special"
      >{</span
      ><span
      >
</span
      ><a name="line-173"
      ></a
      ><span
      >        </span
      ><a href="NationStates.Core.html#queryShards"
      ><span class="hs-identifier hs-var"
	>queryShards</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Map</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >unionWith</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Set</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >union</span
      ><span
      >
</span
      ><a name="line-174"
      ></a
      ><span
      >            </span
      ><span class="hs-special"
      >(</span
      ><a href="NationStates.Core.html#queryShards"
      ><span class="hs-identifier hs-var"
	>queryShards</span
	></a
      ><span
      > </span
      ><a href="#local-1627435282"
      ><span class="hs-identifier hs-var"
	>a</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><a href="NationStates.Core.html#queryShards"
      ><span class="hs-identifier hs-var"
	>queryShards</span
	></a
      ><span
      > </span
      ><a href="#local-1627435283"
      ><span class="hs-identifier hs-var"
	>b</span
	></a
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-175"
      ></a
      ><span
      >        </span
      ><a href="NationStates.Core.html#queryOptions"
      ><span class="hs-identifier hs-var"
	>queryOptions</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Map</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >unionWithKey</span
      ><span
      > </span
      ><a href="#local-1627435284"
      ><span class="hs-identifier hs-var"
	>mergeOptions</span
	></a
      ><span
      >
</span
      ><a name="line-176"
      ></a
      ><span
      >            </span
      ><span class="hs-special"
      >(</span
      ><a href="NationStates.Core.html#queryOptions"
      ><span class="hs-identifier hs-var"
	>queryOptions</span
	></a
      ><span
      > </span
      ><a href="#local-1627435282"
      ><span class="hs-identifier hs-var"
	>a</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><a href="NationStates.Core.html#queryOptions"
      ><span class="hs-identifier hs-var"
	>queryOptions</span
	></a
      ><span
      > </span
      ><a href="#local-1627435283"
      ><span class="hs-identifier hs-var"
	>b</span
	></a
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-177"
      ></a
      ><span
      >        </span
      ><a href="NationStates.Core.html#queryParams"
      ><span class="hs-identifier hs-var"
	>queryParams</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Map</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >unionWithKey</span
      ><span
      > </span
      ><a href="#local-1627435284"
      ><span class="hs-identifier hs-var"
	>mergeOptions</span
	></a
      ><span
      >
</span
      ><a name="line-178"
      ></a
      ><span
      >            </span
      ><span class="hs-special"
      >(</span
      ><a href="NationStates.Core.html#queryParams"
      ><span class="hs-identifier hs-var"
	>queryParams</span
	></a
      ><span
      > </span
      ><a href="#local-1627435282"
      ><span class="hs-identifier hs-var"
	>a</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><a href="NationStates.Core.html#queryParams"
      ><span class="hs-identifier hs-var"
	>queryParams</span
	></a
      ><span
      > </span
      ><a href="#local-1627435283"
      ><span class="hs-identifier hs-var"
	>b</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><a name="line-179"
      ></a
      ><span
      >        </span
      ><span class="hs-special"
      >}</span
      ><span
      >
</span
      ><a name="line-180"
      ></a
      ><span
      >      </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><a name="line-181"
      ></a
      ><span
      >        </span
      ><a name="local-1627435284"
      ><a href="#local-1627435284"
	><span class="hs-identifier"
	  >mergeOptions</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627435285"
      ><a href="#local-1627435285"
	><span class="hs-identifier"
	  >key</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-identifier"
      >_</span
      ><span
      > </span
      ><span class="hs-identifier"
      >_</span
      ><span
      >
</span
      ><a name="line-182"
      ></a
      ><span
      >            </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >error</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >$</span
      ><span
      > </span
      ><span class="hs-string"
      >&quot;conflicting values for option &quot;</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >++</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >show</span
      ><span
      > </span
      ><a href="#local-1627435285"
      ><span class="hs-identifier hs-var"
	>key</span
	></a
      ><span
      >
</span
      ><a name="line-183"
      ></a
      ><span
      >
</span
      ><a name="line-184"
      ></a
      ><span
      >
</span
      ><a name="line-185"
      ></a
      ><span class="hs-comment"
      >-- | Create a query for a single shard.</span
      ><span
      >
</span
      ><a name="line-186"
      ></a
      ><span class="hs-identifier"
      >shard</span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><a href="NationStates.Core.html#Query"
      ><span class="hs-identifier hs-type"
	>Query</span
	></a
      ><span
      >
</span
      ><a name="line-187"
      ></a
      ><a name="shard"
      ><a href="NationStates.Core.html#shard"
	><span class="hs-identifier"
	  >shard</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627434834"
      ><a href="#local-1627434834"
	><span class="hs-identifier"
	  >name</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >mempty</span
      ><span
      > </span
      ><span class="hs-special"
      >{</span
      ><span
      >
</span
      ><a name="line-188"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#queryShards"
      ><span class="hs-identifier hs-var"
	>queryShards</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Map</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >singleton</span
      ><span
      > </span
      ><a href="#local-1627434834"
      ><span class="hs-identifier hs-var"
	>name</span
	></a
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-var"
      >Set</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >singleton</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Nothing</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >}</span
      ><span
      >
</span
      ><a name="line-189"
      ></a
      ><span
      >
</span
      ><a name="line-190"
      ></a
      ><span class="hs-comment"
      >-- | Create a query for a single shard, with an extra ID.</span
      ><span
      >
</span
      ><a name="line-191"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-192"
      ></a
      ><span class="hs-comment"
      >-- For example, the @censusscore-23@ shard would be written as:</span
      ><span
      >
</span
      ><a name="line-193"
      ></a
      ><span class="hs-comment"
      >-- @shard' &quot;censusscore&quot; 23@.</span
      ><span
      >
</span
      ><a name="line-194"
      ></a
      ><span class="hs-identifier"
      >shard'</span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Integer</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><a href="NationStates.Core.html#Query"
      ><span class="hs-identifier hs-type"
	>Query</span
	></a
      ><span
      >
</span
      ><a name="line-195"
      ></a
      ><a name="shard%27"
      ><a href="NationStates.Core.html#shard%27"
	><span class="hs-identifier"
	  >shard'</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627434835"
      ><a href="#local-1627434835"
	><span class="hs-identifier"
	  >name</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627434836"
      ><a href="#local-1627434836"
	><span class="hs-identifier"
	  >id'</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >mempty</span
      ><span
      > </span
      ><span class="hs-special"
      >{</span
      ><span
      >
</span
      ><a name="line-196"
      ></a
      ><span
      >    </span
      ><a href="NationStates.Core.html#queryShards"
      ><span class="hs-identifier hs-var"
	>queryShards</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Map</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >singleton</span
      ><span
      > </span
      ><a href="#local-1627434835"
      ><span class="hs-identifier hs-var"
	>name</span
	></a
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-var"
      >Set</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >singleton</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-var"
      >Just</span
      ><span
      > </span
      ><a href="#local-1627434836"
      ><span class="hs-identifier hs-var"
	>id'</span
	></a
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-special"
      >}</span
      ><span
      >
</span
      ><a name="line-197"
      ></a
      ><span
      >
</span
      ><a name="line-198"
      ></a
      ><span class="hs-comment"
      >-- | Add extra @;@-delimited arguments.</span
      ><span
      >
</span
      ><a name="line-199"
      ></a
      ><span class="hs-identifier"
      >withOptions</span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><a href="NationStates.Core.html#Query"
      ><span class="hs-identifier hs-type"
	>Query</span
	></a
      ><span
      >
</span
      ><a name="line-200"
      ></a
      ><a name="withOptions"
      ><a href="NationStates.Core.html#withOptions"
	><span class="hs-identifier"
	  >withOptions</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627434837"
      ><a href="#local-1627434837"
	><span class="hs-identifier"
	  >options</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >mempty</span
      ><span
      > </span
      ><span class="hs-special"
      >{</span
      ><span
      > </span
      ><a href="NationStates.Core.html#queryOptions"
      ><span class="hs-identifier hs-var"
	>queryOptions</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Map</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >fromList</span
      ><span
      > </span
      ><a href="#local-1627434837"
      ><span class="hs-identifier hs-var"
	>options</span
	></a
      ><span
      > </span
      ><span class="hs-special"
      >}</span
      ><span
      >
</span
      ><a name="line-201"
      ></a
      ><span
      >
</span
      ><a name="line-202"
      ></a
      ><span class="hs-comment"
      >-- | Add extra @&amp;@-delimited arguments.</span
      ><span
      >
</span
      ><a name="line-203"
      ></a
      ><span class="hs-identifier"
      >withParams</span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><a href="NationStates.Core.html#Query"
      ><span class="hs-identifier hs-type"
	>Query</span
	></a
      ><span
      >
</span
      ><a name="line-204"
      ></a
      ><a name="withParams"
      ><a href="NationStates.Core.html#withParams"
	><span class="hs-identifier"
	  >withParams</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627434838"
      ><a href="#local-1627434838"
	><span class="hs-identifier"
	  >params</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >mempty</span
      ><span
      > </span
      ><span class="hs-special"
      >{</span
      ><span
      > </span
      ><a href="NationStates.Core.html#queryParams"
      ><span class="hs-identifier hs-var"
	>queryParams</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Map</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >fromList</span
      ><span
      > </span
      ><a href="#local-1627434838"
      ><span class="hs-identifier hs-var"
	>params</span
	></a
      ><span
      > </span
      ><span class="hs-special"
      >}</span
      ><span
      >
</span
      ><a name="line-205"
      ></a
      ><span
      >
</span
      ><a name="line-206"
      ></a
      ><span
      >
</span
      ><a name="line-207"
      ></a
      ><span class="hs-identifier"
      >queryToString</span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Maybe</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><a href="NationStates.Core.html#Query"
      ><span class="hs-identifier hs-type"
	>Query</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >ByteString</span
      ><span
      >
</span
      ><a name="line-208"
      ></a
      ><a name="queryToString"
      ><a href="NationStates.Core.html#queryToString"
	><span class="hs-identifier"
	  >queryToString</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627434839"
      ><a href="#local-1627434839"
	><span class="hs-identifier"
	  >kindAndName</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627434840"
      ><a href="#local-1627434840"
	><span class="hs-identifier"
	  >q</span
	  ></a
	></a
      ><span
      >
</span
      ><a name="line-209"
      ></a
      ><span
      >    </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >HTTP</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >renderQuery</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >True</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-var"
      >HTTP</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >toQuery</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >$</span
      ><span
      >
</span
      ><a name="line-210"
      ></a
      ><span
      >        </span
      ><span class="hs-identifier hs-var"
      >F</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >toList</span
      ><span
      > </span
      ><a href="#local-1627434839"
      ><span class="hs-identifier hs-var"
	>kindAndName</span
	></a
      ><span
      >
</span
      ><a name="line-211"
      ></a
      ><span
      >            </span
      ><span class="hs-operator hs-var"
      >++</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Map</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >toList</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><a href="NationStates.Core.html#queryParams"
      ><span class="hs-identifier hs-var"
	>queryParams</span
	></a
      ><span
      > </span
      ><a href="#local-1627434840"
      ><span class="hs-identifier hs-var"
	>q</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><a name="line-212"
      ></a
      ><span
      >            </span
      ><span class="hs-operator hs-var"
      >++</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >(</span
      ><span class="hs-string"
      >&quot;q&quot;</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><a href="#local-1627434841"
      ><span class="hs-identifier hs-var"
	>shards</span
	></a
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-string"
      >&quot;v&quot;</span
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >show</span
      ><span
      > </span
      ><a href="NationStates.Core.html#apiVersion"
      ><span class="hs-identifier hs-var"
	>apiVersion</span
	></a
      ><span class="hs-special"
      >)</span
      ><span class="hs-special"
      >]</span
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><a name="line-213"
      ></a
      ><span
      >    </span
      ><span class="hs-operator hs-var"
      >&lt;&gt;</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >BC</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >pack</span
      ><span
      > </span
      ><a href="#local-1627434842"
      ><span class="hs-identifier hs-var"
	>options</span
	></a
      ><span
      >
</span
      ><a name="line-214"
      ></a
      ><span
      >  </span
      ><span class="hs-keyword"
      >where</span
      ><span
      >
</span
      ><a name="line-215"
      ></a
      ><span
      >    </span
      ><a name="local-1627434841"
      ><a href="#local-1627434841"
	><span class="hs-identifier"
	  >shards</span
	  ></a
	></a
      ><span
      >
</span
      ><a name="line-216"
      ></a
      ><span
      >        </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Map</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >null</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><a href="NationStates.Core.html#queryShards"
      ><span class="hs-identifier hs-var"
	>queryShards</span
	></a
      ><span
      > </span
      ><a href="#local-1627434840"
      ><span class="hs-identifier hs-var"
	>q</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-string"
      >&quot;null&quot;</span
      ><span
      >
</span
      ><a name="line-217"
      ></a
      ><span
      >        </span
      ><span class="hs-glyph"
      >|</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >otherwise</span
      ><span
      >
</span
      ><a name="line-218"
      ></a
      ><span
      >            </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >intercalate</span
      ><span
      > </span
      ><span class="hs-string"
      >&quot;+&quot;</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span
      > </span
      ><a href="#local-1627434961"
      ><span class="hs-identifier hs-var"
	>name</span
	></a
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >++</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >F</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >foldMap</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-glyph"
      >\</span
      ><a name="local-1627434964"
      ><a href="#local-1627434964"
	><span class="hs-identifier"
	  >i</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-string"
      >&quot;-&quot;</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >++</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >show</span
      ><span
      > </span
      ><a href="#local-1627434964"
      ><span class="hs-identifier hs-var"
	>i</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><a href="#local-1627434963"
      ><span class="hs-identifier hs-var"
	>maybeId</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >|</span
      ><span
      >
</span
      ><a name="line-219"
      ></a
      ><span
      >                </span
      ><span class="hs-special"
      >(</span
      ><a name="local-1627434961"
      ><a href="#local-1627434961"
	><span class="hs-identifier"
	  >name</span
	  ></a
	></a
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><a name="local-1627434962"
      ><a href="#local-1627434962"
	><span class="hs-identifier"
	  >is</span
	  ></a
	></a
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Map</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >toList</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >$</span
      ><span
      > </span
      ><a href="NationStates.Core.html#queryShards"
      ><span class="hs-identifier hs-var"
	>queryShards</span
	></a
      ><span
      > </span
      ><a href="#local-1627434840"
      ><span class="hs-identifier hs-var"
	>q</span
	></a
      ><span class="hs-special"
      >,</span
      ><span
      >
</span
      ><a name="line-220"
      ></a
      ><span
      >                </span
      ><a name="local-1627434963"
      ><a href="#local-1627434963"
	><span class="hs-identifier"
	  >maybeId</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Set</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >toList</span
      ><span
      > </span
      ><a href="#local-1627434962"
      ><span class="hs-identifier hs-var"
	>is</span
	></a
      ><span
      > </span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><a name="line-221"
      ></a
      ><span
      >    </span
      ><a name="local-1627434842"
      ><a href="#local-1627434842"
	><span class="hs-identifier"
	  >options</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >concat</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span
      > </span
      ><span class="hs-string"
      >&quot;;&quot;</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >++</span
      ><span
      > </span
      ><a href="#local-1627434965"
      ><span class="hs-identifier hs-var"
	>k</span
	></a
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >++</span
      ><span
      > </span
      ><span class="hs-string"
      >&quot;=&quot;</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >++</span
      ><span
      > </span
      ><a href="#local-1627434966"
      ><span class="hs-identifier hs-var"
	>v</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >|</span
      ><span
      >
</span
      ><a name="line-222"
      ></a
      ><span
      >        </span
      ><span class="hs-special"
      >(</span
      ><a name="local-1627434965"
      ><a href="#local-1627434965"
	><span class="hs-identifier"
	  >k</span
	  ></a
	></a
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><a name="local-1627434966"
      ><a href="#local-1627434966"
	><span class="hs-identifier"
	  >v</span
	  ></a
	></a
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >&lt;-</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >Map</span
      ><span class="hs-operator hs-var"
      >.</span
      ><span class="hs-identifier hs-var"
      >toList</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >$</span
      ><span
      > </span
      ><a href="NationStates.Core.html#queryOptions"
      ><span class="hs-identifier hs-var"
	>queryOptions</span
	></a
      ><span
      > </span
      ><a href="#local-1627434840"
      ><span class="hs-identifier hs-var"
	>q</span
	></a
      ><span
      > </span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><a name="line-223"
      ></a
      ><span
      >
</span
      ><a name="line-224"
      ></a
      ><span
      >
</span
      ><a name="line-225"
      ></a
      ><span class="hs-comment"
      >-- | Split a list by the given predicate, dropping empty sublists.</span
      ><span
      >
</span
      ><a name="line-226"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-227"
      ></a
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; wordsBy (== ',') &quot;the_vines,motesardo-east_adanzi,yellowapple&quot;</span
      ><span
      >
</span
      ><a name="line-228"
      ></a
      ><span class="hs-comment"
      >-- [&quot;the_vines&quot;, &quot;montesardo-east_adanzi&quot;, &quot;yellowapple&quot;]</span
      ><span
      >
</span
      ><a name="line-229"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-230"
      ></a
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; wordsBy (== ',') &quot;&quot;</span
      ><span
      >
</span
      ><a name="line-231"
      ></a
      ><span class="hs-comment"
      >-- []</span
      ><span
      >
</span
      ><a name="line-232"
      ></a
      ><span class="hs-identifier"
      >wordsBy</span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><a href="#local-1627434492"
      ><span class="hs-identifier hs-type"
	>a</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Bool</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><a href="#local-1627434492"
      ><span class="hs-identifier hs-type"
	>a</span
	></a
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >[</span
      ><a href="#local-1627434492"
      ><span class="hs-identifier hs-type"
	>a</span
	></a
      ><span class="hs-special"
      >]</span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><a name="line-233"
      ></a
      ><a name="wordsBy"
      ><a href="NationStates.Core.html#wordsBy"
	><span class="hs-identifier"
	  >wordsBy</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627435101"
      ><a href="#local-1627435101"
	><span class="hs-identifier"
	  >p</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627435102"
      ><a href="#local-1627435102"
	><span class="hs-identifier"
	  >s</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >case</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >dropWhile</span
      ><span
      > </span
      ><a href="#local-1627435101"
      ><span class="hs-identifier hs-var"
	>p</span
	></a
      ><span
      > </span
      ><a href="#local-1627435102"
      ><span class="hs-identifier hs-var"
	>s</span
	></a
      ><span
      > </span
      ><span class="hs-keyword"
      >of</span
      ><span
      >
</span
      ><a name="line-234"
      ></a
      ><span
      >    </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >]</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-special"
      >[</span
      ><span class="hs-special"
      >]</span
      ><span
      >
</span
      ><a name="line-235"
      ></a
      ><span
      >    </span
      ><a name="local-1627435275"
      ><a href="#local-1627435275"
	><span class="hs-identifier"
	  >s'</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      >
</span
      ><a name="line-236"
      ></a
      ><span
      >        </span
      ><span class="hs-keyword"
      >let</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><a name="local-1627435276"
      ><a href="#local-1627435276"
	><span class="hs-identifier"
	  >w</span
	  ></a
	></a
      ><span class="hs-special"
      >,</span
      ><span
      > </span
      ><a name="local-1627435277"
      ><a href="#local-1627435277"
	><span class="hs-identifier"
	  >s''</span
	  ></a
	></a
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >break</span
      ><span
      > </span
      ><a href="#local-1627435101"
      ><span class="hs-identifier hs-var"
	>p</span
	></a
      ><span
      > </span
      ><a href="#local-1627435275"
      ><span class="hs-identifier hs-var"
	>s'</span
	></a
      ><span
      >
</span
      ><a name="line-237"
      ></a
      ><span
      >        </span
      ><span class="hs-keyword"
      >in</span
      ><span
      >  </span
      ><a href="#local-1627435276"
      ><span class="hs-identifier hs-var"
	>w</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >:</span
      ><span
      > </span
      ><a href="NationStates.Core.html#wordsBy"
      ><span class="hs-identifier hs-var"
	>wordsBy</span
	></a
      ><span
      > </span
      ><a href="#local-1627435101"
      ><span class="hs-identifier hs-var"
	>p</span
	></a
      ><span
      > </span
      ><a href="#local-1627435277"
      ><span class="hs-identifier hs-var"
	>s''</span
	></a
      ><span
      >
</span
      ><a name="line-238"
      ></a
      ><span
      >
</span
      ><a name="line-239"
      ></a
      ><span class="hs-comment"
      >-- | Parse an input string using the given parser function.</span
      ><span
      >
</span
      ><a name="line-240"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-241"
      ></a
      ><span class="hs-comment"
      >-- If parsing fails, raise an 'error'.</span
      ><span
      >
</span
      ><a name="line-242"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-243"
      ></a
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; (expect &quot;integer&quot; &lt;*&gt; readMaybe) &quot;42&quot; :: Integer</span
      ><span
      >
</span
      ><a name="line-244"
      ></a
      ><span class="hs-comment"
      >-- 42</span
      ><span
      >
</span
      ><a name="line-245"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-246"
      ></a
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; (expect &quot;integer&quot; &lt;*&gt; readMaybe) &quot;butts&quot; :: Integer</span
      ><span
      >
</span
      ><a name="line-247"
      ></a
      ><span class="hs-comment"
      >-- *** Exception: expected integer but got: butts</span
      ><span
      >
</span
      ><a name="line-248"
      ></a
      ><span class="hs-identifier"
      >expect</span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >String</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Maybe</span
      ><span
      > </span
      ><a href="#local-1627434491"
      ><span class="hs-identifier hs-type"
	>a</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><a href="#local-1627434491"
      ><span class="hs-identifier hs-type"
	>a</span
	></a
      ><span
      >
</span
      ><a name="line-249"
      ></a
      ><a name="expect"
      ><a href="NationStates.Core.html#expect"
	><span class="hs-identifier"
	  >expect</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627435278"
      ><a href="#local-1627435278"
	><span class="hs-identifier"
	  >want</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627435279"
      ><a href="#local-1627435279"
	><span class="hs-identifier"
	  >got</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >fromMaybe</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><span class="hs-identifier hs-var"
      >error</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >$</span
      ><span
      > </span
      ><span class="hs-string"
      >&quot;expected &quot;</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >++</span
      ><span
      > </span
      ><a href="#local-1627435278"
      ><span class="hs-identifier hs-var"
	>want</span
	></a
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >++</span
      ><span
      > </span
      ><span class="hs-string"
      >&quot; but got: &quot;</span
      ><span
      > </span
      ><span class="hs-operator hs-var"
      >++</span
      ><span
      > </span
      ><a href="#local-1627435279"
      ><span class="hs-identifier hs-var"
	>got</span
	></a
      ><span class="hs-special"
      >)</span
      ><span
      >
</span
      ><a name="line-250"
      ></a
      ><span
      >
</span
      ><a name="line-251"
      ></a
      ><span class="hs-comment"
      >-- | Return the value only if the given predicate is true.</span
      ><span
      >
</span
      ><a name="line-252"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-253"
      ></a
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; pureIf (&gt; 0) 5 :: Maybe Integer</span
      ><span
      >
</span
      ><a name="line-254"
      ></a
      ><span class="hs-comment"
      >-- Just 5</span
      ><span
      >
</span
      ><a name="line-255"
      ></a
      ><span class="hs-comment"
      >--</span
      ><span
      >
</span
      ><a name="line-256"
      ></a
      ><span class="hs-comment"
      >-- &gt;&gt;&gt; pureIf (&gt; 0) (-2) :: Maybe Integer</span
      ><span
      >
</span
      ><a name="line-257"
      ></a
      ><span class="hs-comment"
      >-- Nothing</span
      ><span
      >
</span
      ><a name="line-258"
      ></a
      ><span class="hs-identifier"
      >pureIf</span
      ><span
      > </span
      ><span class="hs-glyph"
      >::</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Alternative</span
      ><span
      > </span
      ><a href="#local-1627434490"
      ><span class="hs-identifier hs-type"
	>f</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=&gt;</span
      ><span
      > </span
      ><span class="hs-special"
      >(</span
      ><a href="#local-1627434489"
      ><span class="hs-identifier hs-type"
	>a</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><span class="hs-identifier hs-type"
      >Bool</span
      ><span class="hs-special"
      >)</span
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><a href="#local-1627434489"
      ><span class="hs-identifier hs-type"
	>a</span
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >-&gt;</span
      ><span
      > </span
      ><a href="#local-1627434490"
      ><span class="hs-identifier hs-type"
	>f</span
	></a
      ><span
      > </span
      ><a href="#local-1627434489"
      ><span class="hs-identifier hs-type"
	>a</span
	></a
      ><span
      >
</span
      ><a name="line-259"
      ></a
      ><a name="pureIf"
      ><a href="NationStates.Core.html#pureIf"
	><span class="hs-identifier"
	  >pureIf</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627435280"
      ><a href="#local-1627435280"
	><span class="hs-identifier"
	  >p</span
	  ></a
	></a
      ><span
      > </span
      ><a name="local-1627435281"
      ><a href="#local-1627435281"
	><span class="hs-identifier"
	  >x</span
	  ></a
	></a
      ><span
      > </span
      ><span class="hs-glyph"
      >=</span
      ><span
      > </span
      ><span class="hs-keyword"
      >if</span
      ><span
      > </span
      ><a href="#local-1627435280"
      ><span class="hs-identifier hs-var"
	>p</span
	></a
      ><span
      > </span
      ><a href="#local-1627435281"
      ><span class="hs-identifier hs-var"
	>x</span
	></a
      ><span
      > </span
      ><span class="hs-keyword"
      >then</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >pure</span
      ><span
      > </span
      ><a href="#local-1627435281"
      ><span class="hs-identifier hs-var"
	>x</span
	></a
      ><span
      > </span
      ><span class="hs-keyword"
      >else</span
      ><span
      > </span
      ><span class="hs-identifier hs-var"
      >empty</span
      ><span
      >
</span
      ><a name="line-260"
      ></a
      ></pre
    ></body
  ></html
>
